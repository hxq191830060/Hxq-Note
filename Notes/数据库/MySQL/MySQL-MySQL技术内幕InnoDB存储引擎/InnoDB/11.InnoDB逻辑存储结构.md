## InnoDB逻辑存储结构

使用InnoDB存储引擎的表，其数据都被逻辑地存放在 **表空间中**

![17](../picture/17.png)

* **表空间由多个段组成**
* **一个段由多个区组成**
* **一个区64个连续的页组成**
* **一个页中包含多条记录**

### 1. 表空间

* 使用InnoDB存储疫情的表，其数据都存放在**表空间**中
* 默认情况下，所以的表都使用 **共享表空间**
* 如果启用了 **innodb_file_per_table**参数，那么每张表还会额外有一个独立的表空间——**数据，索引，和插入缓冲Bitmap**存放在**独立的表空间**中，**其他的数据(undo信息,插入华冲索引页，系统事务信息，二次写缓冲)** 还是存放在**共享表空间**中
* InnoDB在事务回滚时，不会去收缩表空间，但是会判断其中的undo信息是否还需要，如果不需要，将这些空间标记为可用，供下次undo使用

### 2. 段

表空间由各个段组成——**数据段**，**索引段**，**回滚段**

* 段在一开始时，分配一定的空间

  当段大小<32个页时，都是使用碎片页，不够就申请碎片页

  当段使用完32个页时，后续就是申请一个区的空间（64个连续页）

### 3. 区

区由**连续页**组成，**每个区大小为1MB**，**页大小为16KB**——一个区有**64个连续**的页

### 4. 页

一个页的大小为16KB，页是**InnoDB磁盘管理的最小单位**

后来引入了压缩页，页的大小可以设置为2K，4K，8K

### 5. 行

每个页最多可以存放 **16KB/2-200**行记录（**7992条**行记录）
