我们一般会使用代理主键而不是业务主键

对于代理主键的选择

* 对于单表可以使用自增主键作为代理主键

* 但是对于分平分表的情况——不能使用**自增主键**

因为使用自增主键会造成以下问题



> 自增主键必须连续——只能采用"范围分片"

* 运行期间表无法拓展(分片表1存储0-1亿，分片表2存储1-2亿，分片表3存储2-3亿，如果想让一个分片表存储1.5亿是办不到的)

* 会产生 **尾部热点**效应

  > 如果执行插入操作，那么插入操作都会在分片表3中执行，分片表3压力很大



#### 解决方案

* 使用UUID作为主键（不可以）
* 使用雪花算法生成主键ID

雪花算法生成64位的ID

* 1b：符号位
* 41b：时间戳（毫秒时间）
* 10b：机器ID（生成该ID的机器的ID，意味着集群最大规模可以达到1024个节点）
* 12b：序列号（该序列的长度决定了一个节点1毫秒可以生成的ID数目是4096）