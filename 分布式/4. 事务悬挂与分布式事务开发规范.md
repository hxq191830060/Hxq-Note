事务悬挂——事务始终处于中间态，无法推进到终态，处于悬挂状态

* 原因：比如一阶段超时，管理者发起回滚，参与者执行回滚，然后超时的一阶段请求才到达（空回滚），如果此时允许超时的一阶段请求正常处理，那么就会导致参与者始终处于一阶段，产生了悬挂

* 本质原因——rollback比prepare先执行

* 解决方案——双插防悬挂（目的是让一二阶段可以彼此感知，可以通过记录是否存在判断，也可以通过记录状态判断）


分布式事务参与者开发规范

1. 业务幂等性：一二阶段都必须幂等

2. 不允许提交已经回滚的事务

3. 允许空回滚，参与者返回成功，并记录已经回滚

4. 不允许空提交，参与者要返回失败

5. 防止事务悬挂：一阶段如果发现二阶段执行过，要返回失败

6. 数据可见性：如果分布式事务处理中间态，此时有查询，要兼容中间态数据的可见性