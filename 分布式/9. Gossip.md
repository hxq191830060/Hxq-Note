* 如果希望业务有非常强的可用性（即使只有一个节点存活也能提供服务），那么可以考虑下Gossip协议

* Gossip协议：像流言蜚语一样，使用一种随机，带有传染性的方式，将信息传播到整个网络中（集群中的节点不断通信交换信息），并在一定的时间内，让系统内所有的节点数据一致，**实现最终一致性**
* Gossip协议——去中心化，每个node都是平等的，每个节点每隔一段时间都会与其他节点通信交换信息
* Redis Cluster内部通信使用的是Gossip协议
* 如果发生了数据冲突，在Redis Cluster，每个信息都会携带版本号，以版本号高的为准



## Gossip内容

* Direct Mail（直接邮寄）
* Anti-entropy（反熵）
* Rumor mongering（谣言传播）



### Direct Mail

node向其他节点发送更新数据，当数据发送失败时，将数据缓存下来，然后重传



### Anti-entropy

集群中的每个node，每隔一段时间在集群中随机选择另一个node，互相交换数据来消除数据差异，实现数据的最终一致性（有推，拉，推拉三种方式）



### Rumor mongering

node周期性地向其他节点发送数据，直到所有节点都存储了该数据





## Gossip在Redis Cluster中的应用

* Gossip协议——**节点之间彼此不断通信交换信息**，一段时间后所有节点都会直到集群的完整信息（只要节点之间可以正常通信，最终一定会达到一致的状态），Redis Cluster内采用Gossip协议进行通信
* Gossip消息有4种
  * **ping**——用于检测节点是否在线，交换彼此信息
  * **pong**——响应信息
  * **meet**——用于通知新节点加入集群
  * **fail**——当节点判定集群中另一个节点下线时，会向集群内广播一个fail
* Redis Cluster中Gossip消息带有版本号，当发送数据冲突时，以版本号高的为准
